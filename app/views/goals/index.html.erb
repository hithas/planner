<h1>Goals</h1>

<p><a href="/new_goal">Add a New Goal</a> | <a href="/category_index">View by category</a></p>

<br />
<br />

<% @goals.each do |goal| %>

<div class="container" style="width: 500px; display: inline-block;" id="<%= goal.id %>">
    
<div class="panel panel-default">
      <!-- Default panel contents -->
      <div class="panel-heading" style="background-color: <%=Category.find_by(id: goal.category_id).color %>;"><a href="/goals/<%= goal.id %>"><%= goal.name %></a></div>
      <div class="panel-body">
        <p><%= goal.desc %></p>

      </div>
  <a href='/goals/<%= goal.id %>/i/add_checkpoint'> Add Checkpoint </a>
      <!-- Table -->
      <table class="table">
        <tbody>
          
          <% Checkpoint.where(goal_id: goal.id).each do |checkpoint|%>
            <tr>
              <td><span id = "text_<%=checkpoint.id%>"> <%= checkpoint.name %> </span>
                <form id = "form_<%=checkpoint.id%>">
                  <input type='text' name='name' value = '<%=checkpoint.name%>'>
                  <input type = "submit">
                </form>
              <script>
                  $('form').hide();
              </script>
              </td>
               
              <% if checkpoint.completed %>
              <td><span class="glyphicon glyphicon-ok">  </span></td>
              <% else %>
              <td><span id = 'dash_<%=checkpoint.id%>'>-</span></td>
              <script>
                $('#dash_<%=checkpoint.id%>').click( function() {
                  $('#dash_<%=checkpoint.id%>').addClass("glyphicon glyphicon-ok");
                  <% c = Checkpoint.find_by(id: checkpoint.id) %>
                    <% c.completed = true %>
                    <% c.save %>
                });
              </script>
              <% end %>
              <td>-</td>
              <td>-</td>
              <td><span class="glyphicon glyphicon-pencil"  id='edit_<%=checkpoint.id%>'>  </span>
                
                 <script>
                $('#edit_<%=checkpoint.id%>').click( function() {
                  
                  $("#form_<%=checkpoint.id%>").show();
                  $("#text_<%=checkpoint.id%>").hide();

                });
                </script>
              </td>
              <td><span id='remove_<%=checkpoint.id%>' class="glyphicon glyphicon-remove"> </span>
              <script>
                $('#remove_<%=checkpoint.id%>').click( function() {
                  
                  $('#dash_<%=checkpoint.id%>').removeClass("glyphicon glyphicon-ok");
                  <% c = Checkpoint.find_by(id: checkpoint.id)%>
                    <% c.completed = true %>
                    <% c.save %>
                });
              </script>
              
              
              </td>
               
            </tr>
          <% end %>
        </tbody>
      </table>
    </div>

<a href="/goals/<%= goal.id %>/edit">Edit</a> |
<a href="/goals/<%= goal.id %>/destroy">Destroy</a>

<br />
<br />
<br />
<br />

</div>  
<% end %>


  
 

